name: CI/CD Pipeline\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  build-and-test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Set up Node.js\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18'\n          cache: 'npm'\n      \n      - name: Record Start Time\n        id: start_time\n        run: echo \"start_time=$(date +%s)\" >> $GITHUB_OUTPUT\n      \n      - name: Install dependencies\n        run: npm ci\n      \n      - name: Run tests\n        run: npm test -- --watch=false --browsers=ChromeHeadless\n      \n      - name: Build\n        run: npm run build\n      \n      - name: Record End Time\n        id: end_time\n        run: echo \"end_time=$(date +%s)\" >> $GITHUB_OUTPUT\n      \n      - name: Calculate Build Time\n        run: |\n          start_time=${{ steps.start_time.outputs.start_time }}\n          end_time=${{ steps.end_time.outputs.end_time }}\n          build_time=$((end_time - start_time))\n          echo \"BUILD_TIME=$build_time\" >> $GITHUB_ENV\n          echo \"Build took $build_time seconds\"\n\n      - name: Create Build Metrics\n        run: |\n          echo \"Repository: travel-booking-tours\" >> build-metrics.txt\n          echo \"Branch: ${{ github.ref_name }}\" >> build-metrics.txt\n          echo \"Commit: ${{ github.sha }}\" >> build-metrics.txt\n          echo \"Build Time: ${{ env.BUILD_TIME }} seconds\" >> build-metrics.txt\n          echo \"Status: ${{ job.status }}\" >> build-metrics.txt\n          echo \"Date: $(date)\" >> build-metrics.txt\n          cat build-metrics.txt\n\n      - name: Upload Build Time Metrics\n        uses: actions/upload-artifact@v3\n        with:\n          name: build-metrics\n          path: build-metrics.txt\n\n  deploy:\n    needs: build-and-test\n    runs-on: ubuntu-latest\n    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Set up Node.js\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18'\n          cache: 'npm'\n      \n      - name: Install dependencies\n        run: npm ci\n      \n      - name: Build\n        run: npm run build\n      \n      - name: Deploy to GitHub Pages\n        uses: JamesIves/github-pages-deploy-action@v4\n        with:\n          folder: dist/tours-angular\n          branch: gh-pages